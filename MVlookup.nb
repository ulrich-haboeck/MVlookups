(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     79031,       1831]
NotebookOptionsPosition[     75369,       1707]
NotebookOutlinePosition[     75708,       1722]
CellTagsIndexPosition[     75665,       1719]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"cost", " ", "of", " ", "MV", " ", "sumcheck"}], ",", " ", 
    RowBox[{
     RowBox[{"relative", " ", "to", " ", "the", " ", "size"}], "|", "H", "|", 
     " ", 
     RowBox[{
      RowBox[{"of", " ", "the", " ", "n"}], "-", 
      RowBox[{"dimensional", " ", "hypercube"}]}]}]}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "@", "sumcheck"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"sumcheck", "[", 
     RowBox[{"n_", ",", "d_", ",", "numVars_", ",", 
      RowBox[{"{", 
       RowBox[{"Qm_", ",", "Qs_", ",", "Qa_"}], "}"}]}], "]"}], ":=", "\n", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"1", "/", 
        RowBox[{"2", "^", 
         RowBox[{"(", "n", ")"}]}]}]}], ")"}], " ", "*", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"d", "*", "numVars"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", "1"}], ")"}], " ", "*", " ", "Qm"}]}], ",", " ", 
       RowBox[{"numVars", " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", " ", "+", " ", "1"}], ")"}], " ", "*", " ", "Qs"}]}], 
       ",", " ", 
       RowBox[{
        RowBox[{"d", "*", "numVars"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", "1"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"Qa", " ", "+", " ", "1"}], ")"}]}]}]}], "}"}], 
     " "}]}]}]}]], "Code",
 CellChangeTimes->{{3.8750892597671213`*^9, 3.8750893986050997`*^9}, {
   3.8750894332159452`*^9, 3.875089434032494*^9}, {3.875089522618288*^9, 
   3.8750895264495363`*^9}, {3.875090719855582*^9, 3.875090921681652*^9}, 
   3.875091020506954*^9, 3.875095525984243*^9, {3.875464062927775*^9, 
   3.875464063514955*^9}, {3.8754642664194927`*^9, 3.875464274987112*^9}, {
   3.878627288886423*^9, 3.878627307175211*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"From", " ", "Berstein", " ", "and", " ", "Lange"}], ",", " ", 
    "2007", ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Analysis", " ", "of", " ", "EC", " ", "single", " ", "scalar", " ", 
       "multiplication", "\[IndentingNewLine]", "costPerScalarBit"}], " ", 
      "=", " ", "8"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"InvEdwards", " ", "coordinates"}], " ", "*)"}], "\n", 
     RowBox[{"costPerScalarMul", " ", "=", " ", 
      RowBox[{
       RowBox[{"8", "*", "255", "\n", "costPippengerPerScalar"}], " ", "=", 
       " ", 
       RowBox[{"costPerScalarMul", "/", "12"}]}]}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"1", " ", "/", " ", "log"}], "|", "H", "|"}], ",", " ", 
     RowBox[{
      RowBox[{"with", " ", "|", "H", "|"}], "=", 
      RowBox[{"2", "^", "12"}]}]}], " ", "*)"}], " ", "\n", "*)"}], "\n", 
  "\n", 
  RowBox[{"(*", " ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Cost", " ", "of", " ", "Pippenger", " ", "in", " ", "terms", " ", "of", 
      " ", "field", " ", 
      RowBox[{"multiplications", ".", "\n", "Based"}], " ", "on", " ", 
      "Marcin", " ", "single"}], "-", 
     RowBox[{"threaded", " ", "benchmarks", " ", "of", " ", "Pippenger", "\n", 
      RowBox[{"https", ":"}]}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"github", ".", "com"}], "/", "Orbis"}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"Tertius", "/", "Orbis"}], "/", "issues"}], "/", "97"}]}]}], 
   "\n", "*)"}], "\n", "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"instanceSizes", " ", "=", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"12", ",", "18"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"benchesPippenger", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "46.010", ",", " ", "82.382", ",", " ", "153.67", ",", " ", "279.35", 
       ",", " ", "522.13", ",", " ", "1003.4", ",", " ", "1869.5"}], "}"}]}], 
    ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"for", " ", "N"}], "=", "12"}], ",", " ", "13", ",", "...", ",",
      " ", "18"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"benchesFieldMul", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "21.110", ",", " ", "42.315", ",", " ", "84.777", ",", " ", "169.70", 
       ",", " ", "339.25", ",", " ", "679.27", ",", " ", "1360.6"}], "}"}]}], 
    ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"for", " ", 
     RowBox[{"2", "^", "8"}], " ", "*", " ", "N"}], " ", "*)"}], "\n", 
   RowBox[{"equivalentMuls", " ", "=", " ", 
    RowBox[{
     RowBox[{"benchesPippenger", "/", "benchesFieldMul"}], " ", "*", " ", 
     RowBox[{"2", "^", "8"}]}]}]}]}]], "Code",
 CellChangeTimes->{
  3.876385782402144*^9, {3.876546678241295*^9, 3.876546833037793*^9}, {
   3.8765470262945023`*^9, 3.876547038754353*^9}, {3.87655572188908*^9, 
   3.876556138055821*^9}, {3.8765561847248993`*^9, 3.876556222062521*^9}, 
   3.876556258761971*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "557.9611558503079`", ",", "498.39990547087325`", ",", 
   "464.03529259115084`", ",", "421.41190335886864`", ",", 
   "394.00229918938834`", ",", "378.1565504144155`", ",", 
   "351.75069822137294`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.876556259442092*^9, 3.876556717781522*^9, 3.8765601122094593`*^9, 
   3.8765601718109207`*^9, 3.876560948777672*^9, {3.876565089141786*^9, 
   3.876565141901601*^9}, 3.876572676005343*^9, 3.8769972609926777`*^9, 
   3.87862626160359*^9, 3.87862883753666*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxM", " ", "=", " ", "200"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"domainSize", " ", "=", " ", "12"}], ";"}], "\n", 
 RowBox[{"costPippengerPerScalar", " ", "=", " ", 
  RowBox[{"equivalentMuls", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"instanceSizes", ",", " ", "domainSize"}], "]"}], "//", 
      "Flatten"}], "//", "First"}], "]"}], "]"}]}]}], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQPW9L4bp5D9846nWfA9OSDF/M3gJpF/8fYFrrofuO
j0D6yQF/MO0xpfQriDY93AimhdIOzP0MpNU0LoPpPEefpSD6EVM4mI4QimX7
AqSPSaaD6XK7N9zfgLTh9FIhEB2i7nHgJ5Ce9dMfTO87byT59Okbx4o3VmB6
TegZJxCt33kNTC/bbJIMohv+WoFpv1SzPSA6l8kGTC+8bnQQRB+KdgTTnfHH
joJohROOJ0H0u5qpQi+BdFviLDB95HK6BIg+wJIDprdERcmCaL6WRDAtcP7o
GRC9Kv/PJRAdxeJwD0R3HXAF02qSix+B6E3rV4BpzpqSZyA663QFmAYAjknZ
RA==
  "]],

Cell[BoxData["557.9611558503079`"], "Output",
 CellChangeTimes->{{3.876556228208119*^9, 3.8765562564138317`*^9}, {
   3.8765567178043118`*^9, 3.87655671821242*^9}, {3.8765601122130632`*^9, 
   3.876560112567276*^9}, {3.876560171830325*^9, 3.876560172126446*^9}, {
   3.876560948797903*^9, 3.8765609491039953`*^9}, {3.8765650891547327`*^9, 
   3.876565142228589*^9}, {3.876572676018879*^9, 3.876572676427266*^9}, {
   3.876997261037283*^9, 3.8769972627925158`*^9}, 3.878626261721401*^9, 
   3.8786275302797747`*^9, 3.8786278634258213`*^9, 3.878628122440507*^9, {
   3.87862883755542*^9, 3.8786288380929737`*^9}, 3.8786288745401907`*^9, {
   3.8786289107451763`*^9, 3.8786289385347767`*^9}, 3.87863566928541*^9, 
   3.8786357157739*^9, 3.878635755594203*^9, {3.87863715877419*^9, 
   3.878637208414145*^9}, 3.878637298564089*^9, 3.878637333620162*^9, 
   3.8786373642159843`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Based on the logarithmic derivative", "Section",
 CellChangeTimes->{{3.876385540206491*^9, 3.8763855496770477`*^9}}],

Cell[CellGroupData[{

Cell["small number of columns", "Subsection",
 CellChangeTimes->{{3.87657263997535*^9, 3.876572644391529*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"arithComp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"4", "M"}], " ", "+", " ", "1"}], ",", "1", ",", 
     RowBox[{"M", "+", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"costsumcheck", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"sumcheck", "[", 
     RowBox[{"n", ",", " ", 
      RowBox[{"M", "+", "3"}], ",", 
      RowBox[{"M", "+", "4"}], ",", " ", "arithComp"}], " ", "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", " ", "-", " ", 
      RowBox[{"1", "/", 
       RowBox[{"2", "^", "n"}]}]}], ")"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"cost", " ", "=", " ", 
  RowBox[{
   RowBox[{"costsumcheck", "+", " ", 
    RowBox[{"{", 
     RowBox[{"7", ",", " ", "1", ",", " ", 
      RowBox[{
       RowBox[{"2", "M"}], "+", "1"}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Code",
 CellChangeTimes->{{3.8750909259659147`*^9, 3.8750909755423727`*^9}, {
   3.875091011817265*^9, 3.875091011971953*^9}, {3.875091761347869*^9, 
   3.8750917685033712`*^9}, {3.875095922978674*^9, 3.875095924237027*^9}, {
   3.875102731687755*^9, 3.875102732249934*^9}, {3.8751027766648827`*^9, 
   3.8751027771588306`*^9}, {3.8751035450282717`*^9, 3.875103545106289*^9}, {
   3.875103575541709*^9, 3.875103575695881*^9}, {3.87544903570872*^9, 
   3.875449051990718*^9}, {3.875459791604109*^9, 3.875459793447543*^9}, {
   3.875460098494342*^9, 3.875460146550344*^9}, 3.8754622749212112`*^9, {
   3.8754623550682497`*^9, 3.875462355922514*^9}, {3.8754628105165787`*^9, 
   3.8754628283143*^9}, {3.875462860582975*^9, 3.875462874171104*^9}, {
   3.8754629739336987`*^9, 3.8754629980591993`*^9}, {3.875464304445507*^9, 
   3.8754643097529507`*^9}, {3.875464374646179*^9, 3.875464379549264*^9}, {
   3.875464667348877*^9, 3.875464667406427*^9}, {3.875464789979189*^9, 
   3.87546480291568*^9}, {3.875464900566935*^9, 3.875464925993936*^9}, {
   3.8754665630601683`*^9, 3.875466563364303*^9}, {3.875603537872497*^9, 
   3.875603540199489*^9}, {3.87560358270327*^9, 3.875603659183642*^9}, {
   3.875604134438981*^9, 3.875604134819813*^9}, 3.875604513449641*^9, {
   3.8757017826018*^9, 3.87570182248929*^9}, {3.876295114711844*^9, 
   3.876295115023265*^9}, {3.876385582696113*^9, 3.876385587334529*^9}, {
   3.8763857218627453`*^9, 3.8763857221737823`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"16", "+", 
    RowBox[{"24", " ", "M"}], "+", 
    RowBox[{"5", " ", 
     SuperscriptBox["M", "2"]}]}], ",", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"4", "+", "M"}], ")"}]}], ",", 
   RowBox[{"20", "+", 
    RowBox[{"13", " ", "M"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["M", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385715009602*^9, 3.876385722596904*^9}, 
   3.8763867511917953`*^9, 3.876388874745801*^9, 3.876545897342609*^9, 
   3.876546877593207*^9, 3.876547012008567*^9, 3.8765562564425907`*^9, 
   3.8765567179227877`*^9, 3.876560112246744*^9, 3.876560171852413*^9, 
   3.8765609488236647`*^9, {3.876565089189497*^9, 3.87656514196437*^9}, 
   3.876572676140774*^9, 3.876997261144877*^9, 3.878626261787403*^9, {
   3.8786273163689213`*^9, 3.878627328095007*^9}, 3.878628126233686*^9, 
   3.878628837582266*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"23", "+", 
    RowBox[{"24", " ", "M"}], "+", 
    RowBox[{"5", " ", 
     SuperscriptBox["M", "2"]}]}], ",", 
   RowBox[{"9", "+", 
    RowBox[{"2", " ", "M"}]}], ",", 
   RowBox[{"21", "+", 
    RowBox[{"15", " ", "M"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["M", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385715009602*^9, 3.876385722596904*^9}, 
   3.8763867511917953`*^9, 3.876388874745801*^9, 3.876545897342609*^9, 
   3.876546877593207*^9, 3.876547012008567*^9, 3.8765562564425907`*^9, 
   3.8765567179227877`*^9, 3.876560112246744*^9, 3.876560171852413*^9, 
   3.8765609488236647`*^9, {3.876565089189497*^9, 3.87656514196437*^9}, 
   3.876572676140774*^9, 3.876997261144877*^9, 3.878626261787403*^9, {
   3.8786273163689213`*^9, 3.878627328095007*^9}, 3.878628126233686*^9, 
   3.878628837582889*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["large number of columns (old)", "Subsection",
 CellChangeTimes->{{3.876385600508483*^9, 3.876385604712728*^9}, {
  3.8786281306070147`*^9, 3.8786281322326202`*^9}}],

Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"The", " ", "old", " ", "variant", " ", "for", " ", "M"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"2", "^", "m"}], " ", "number", " ", "of", " ", 
      RowBox[{"columns", ".", "\n", "arithComp"}]}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1", ",", "2"}], "}"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"costsumcheckLargeM", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"M", " ", "*", " ", 
       RowBox[{
        RowBox[{"sumcheck", "[", 
         RowBox[{
          RowBox[{"n", "+", "m"}], ",", " ", "4", ",", " ", "5", ",", " ", 
          "arithComp"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"1", "/", 
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"n", "+", "m"}], ")"}]}]}]}], ")"}]}]}], "//", 
      RowBox[{"Simplify", "\[IndentingNewLine]", "costLargeM"}]}], " ", "=", 
     " ", 
     RowBox[{
      RowBox[{"costsumcheckLargeM", " ", "+", " ", 
       RowBox[{"M", " ", "*", " ", 
        RowBox[{"{", 
         RowBox[{"4", ",", " ", "0", ",", " ", "2"}], "}"}]}]}], "//", 
      "Simplify"}]}]}]}], "\n", "*)"}]], "Code",
 CellChangeTimes->{{3.8750909259659147`*^9, 3.8750909755423727`*^9}, {
   3.875091011817265*^9, 3.875091011971953*^9}, {3.875091761347869*^9, 
   3.8750917685033712`*^9}, {3.875095922978674*^9, 3.875095924237027*^9}, {
   3.875102731687755*^9, 3.875102732249934*^9}, {3.8751027766648827`*^9, 
   3.8751027771588306`*^9}, {3.8751035450282717`*^9, 3.875103545106289*^9}, {
   3.875103575541709*^9, 3.875103575695881*^9}, {3.87544903570872*^9, 
   3.875449051990718*^9}, {3.875459791604109*^9, 3.875459793447543*^9}, {
   3.875460098494342*^9, 3.875460146550344*^9}, 3.8754622749212112`*^9, {
   3.8754623550682497`*^9, 3.875462355922514*^9}, {3.8754628105165787`*^9, 
   3.8754628283143*^9}, {3.875462860582975*^9, 3.875462874171104*^9}, {
   3.8754629739336987`*^9, 3.8754629980591993`*^9}, {3.875464304445507*^9, 
   3.8754643097529507`*^9}, {3.875464374646179*^9, 3.875464379549264*^9}, {
   3.875464667348877*^9, 3.875464667406427*^9}, {3.875464789979189*^9, 
   3.87546480291568*^9}, {3.875464900566935*^9, 3.875464925993936*^9}, {
   3.8754665630601683`*^9, 3.875466563364303*^9}, {3.875603537872497*^9, 
   3.875603540199489*^9}, {3.87560358270327*^9, 3.875603659183642*^9}, {
   3.875604134438981*^9, 3.875604134819813*^9}, 3.875604513449641*^9, {
   3.8757017826018*^9, 3.87570182248929*^9}, {3.876294935922762*^9, 
   3.876294976871594*^9}, {3.8762950096121683`*^9, 3.87629504286515*^9}, {
   3.876295088768346*^9, 3.876295091983234*^9}, {3.876295140653759*^9, 
   3.8762952201241207`*^9}, {3.8762954318300037`*^9, 3.876295438845056*^9}, {
   3.876368111846792*^9, 3.876368114205063*^9}, {3.876385621768506*^9, 
   3.876385712184557*^9}, {3.878624168092976*^9, 3.8786241956305656`*^9}, {
   3.878627555026208*^9, 3.878627576104622*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["large number of columns", "Subsection",
 CellChangeTimes->{{3.876385600508483*^9, 3.876385604712728*^9}, {
  3.878626156903194*^9, 3.878626157128168*^9}, {3.8786281374309053`*^9, 
  3.878628137634898*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"arithComp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"M", "+", "2"}], ")"}]}], ",", 
     RowBox[{"M", "+", "2"}], ",", 
     RowBox[{"2", "M"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"costsumcheckLargeM", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"sumcheck", "[", 
     RowBox[{"n", ",", " ", "3", ",", " ", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"M", "+", "2"}], ")"}]}], ",", " ", "arithComp"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", " ", "-", " ", 
      RowBox[{"1", "/", 
       RowBox[{"2", "^", "n"}]}]}], ")"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"costLargeM", " ", "=", " ", 
  RowBox[{
   RowBox[{"costsumcheckLargeM", " ", "+", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"3", 
        RowBox[{"(", 
         RowBox[{"M", "+", "1"}], ")"}]}], "+", "1"}], ",", " ", "0", ",", 
      " ", 
      RowBox[{"M", "+", "2"}]}], "}"}]}], "//", "Simplify"}]}]}], "Code",
 CellChangeTimes->{{3.8750909259659147`*^9, 3.8750909755423727`*^9}, {
   3.875091011817265*^9, 3.875091011971953*^9}, {3.875091761347869*^9, 
   3.8750917685033712`*^9}, {3.875095922978674*^9, 3.875095924237027*^9}, {
   3.875102731687755*^9, 3.875102732249934*^9}, {3.8751027766648827`*^9, 
   3.8751027771588306`*^9}, {3.8751035450282717`*^9, 3.875103545106289*^9}, {
   3.875103575541709*^9, 3.875103575695881*^9}, {3.87544903570872*^9, 
   3.875449051990718*^9}, {3.875459791604109*^9, 3.875459793447543*^9}, {
   3.875460098494342*^9, 3.875460146550344*^9}, 3.8754622749212112`*^9, {
   3.8754623550682497`*^9, 3.875462355922514*^9}, {3.8754628105165787`*^9, 
   3.8754628283143*^9}, {3.875462860582975*^9, 3.875462874171104*^9}, {
   3.8754629739336987`*^9, 3.8754629980591993`*^9}, {3.875464304445507*^9, 
   3.8754643097529507`*^9}, {3.875464374646179*^9, 3.875464379549264*^9}, {
   3.875464667348877*^9, 3.875464667406427*^9}, {3.875464789979189*^9, 
   3.87546480291568*^9}, {3.875464900566935*^9, 3.875464925993936*^9}, {
   3.8754665630601683`*^9, 3.875466563364303*^9}, {3.875603537872497*^9, 
   3.875603540199489*^9}, {3.87560358270327*^9, 3.875603659183642*^9}, {
   3.875604134438981*^9, 3.875604134819813*^9}, 3.875604513449641*^9, {
   3.8757017826018*^9, 3.87570182248929*^9}, {3.876294935922762*^9, 
   3.876294976871594*^9}, {3.8762950096121683`*^9, 3.87629504286515*^9}, {
   3.876295088768346*^9, 3.876295091983234*^9}, {3.876295140653759*^9, 
   3.8762952201241207`*^9}, {3.8762954318300037`*^9, 3.876295438845056*^9}, {
   3.876368111846792*^9, 3.876368114205063*^9}, {3.876385621768506*^9, 
   3.876385712184557*^9}, {3.878624168092976*^9, 3.8786241956305656`*^9}, {
   3.878626169455858*^9, 3.878626244826724*^9}, {3.87862635220826*^9, 
   3.878626380076909*^9}, {3.878628141038824*^9, 3.878628142143676*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"14", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "M"}], ")"}]}], ",", 
   RowBox[{"6", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "M"}], ")"}]}], ",", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"8", "+", 
      RowBox[{"7", " ", "M"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385715044609*^9, 3.876385715142146*^9}, 
   3.87638675119805*^9, 3.8763888747507277`*^9, 3.8765458973800983`*^9, 
   3.876546877627763*^9, 3.876547012024343*^9, 3.876556256464425*^9, 
   3.8765567179640636`*^9, 3.876560112250761*^9, 3.8765601718693943`*^9, 
   3.8765609488288097`*^9, {3.876565089207079*^9, 3.876565141969204*^9}, 
   3.876572676165784*^9, 3.876997261153358*^9, {3.878626261864999*^9, 
   3.878626262152989*^9}, 3.878626385129361*^9, 3.878627340159659*^9, 
   3.878628143315895*^9, 3.87862883760748*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"32", "+", 
    RowBox[{"17", " ", "M"}]}], ",", 
   RowBox[{"6", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "M"}], ")"}]}], ",", 
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{"6", "+", 
      RowBox[{"5", " ", "M"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385715044609*^9, 3.876385715142146*^9}, 
   3.87638675119805*^9, 3.8763888747507277`*^9, 3.8765458973800983`*^9, 
   3.876546877627763*^9, 3.876547012024343*^9, 3.876556256464425*^9, 
   3.8765567179640636`*^9, 3.876560112250761*^9, 3.8765601718693943`*^9, 
   3.8765609488288097`*^9, {3.876565089207079*^9, 3.876565141969204*^9}, 
   3.876572676165784*^9, 3.876997261153358*^9, {3.878626261864999*^9, 
   3.878626262152989*^9}, 3.878626385129361*^9, 3.878627340159659*^9, 
   3.878628143315895*^9, 3.8786288376081743`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["break even point", "Subsection",
 CellChangeTimes->{{3.876385748469411*^9, 3.876385752247199*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"costWithComm", " ", "=", " ", 
  RowBox[{"cost", " ", "+", " ", 
   RowBox[{"costPippengerPerScalar", "*", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costWithCommLarge", " ", "=", " ", 
   RowBox[{"costLargeM", " ", "+", " ", 
    RowBox[{"costPippengerPerScalar", "*", 
     RowBox[{"(", 
      RowBox[{"M", "+", "2"}], ")"}]}]}]}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "break", " ", "even", " ", "point", " ", "with", " ", "linear", " ", 
    "strategy"}], " ", "*)"}]}], "\n", 
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"NSolve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"costWithComm", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
     RowBox[{"costWithCommLarge", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "M"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"breakEven", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"M", " ", "/.", " ", "sol"}], " ", "//", " ", "Last"}], "//", 
    "Floor"}]}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"maximum", " ", "speedup"}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"ratio", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"costWithCommLarge", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"costWithComm", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"M", "\[Rule]", "x"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", " ", "breakEven"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"max", " ", "=", " ", 
   RowBox[{"Max", "@", "ratio"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"max", "//", "N"}], "\[IndentingNewLine]", 
 RowBox[{"best", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"ratio", ",", "max"}], "]"}], "//", "Flatten"}], "//", 
   "First"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"costWithComm", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
   RowBox[{"{", 
    RowBox[{"M", "\[Rule]", " ", "best"}], "}"}]}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "range", " ", "for", " ", "0.8", " ", "of", " ", "the", " ", "maximum", 
    " ", "speedup"}], " ", "*)"}]}], "\n", 
 RowBox[{"threshold", " ", "=", " ", "1.5"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "\[GreaterEqual]", "threshold"}], ")"}], "&"}], "/@", 
      "ratio"}], ",", "True"}], "]"}], "//", "Flatten"}], "\n"}], "\n", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"ratio", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Code",
 CellChangeTimes->{{3.8763858044317017`*^9, 3.876385921151272*^9}, {
  3.876386743411701*^9, 3.876386838144216*^9}, {3.8763889126917133`*^9, 
  3.8763889257377234`*^9}, {3.8786274546520033`*^9, 3.8786274548058653`*^9}, {
  3.878636207007628*^9, 3.878636283644246*^9}, {3.8786369920498333`*^9, 
  3.8786369951912203`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"726.5013964427459`", "\[VeryThinSpace]", "+", 
    RowBox[{"24", " ", "M"}], "+", 
    RowBox[{"5", " ", 
     SuperscriptBox["M", "2"]}]}], ",", 
   RowBox[{"712.5013964427459`", "\[VeryThinSpace]", "+", 
    RowBox[{"2", " ", "M"}]}], ",", 
   RowBox[{"724.5013964427459`", "\[VeryThinSpace]", "+", 
    RowBox[{"15", " ", "M"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["M", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, {
   3.8763867512289867`*^9, 3.8763868387229633`*^9}, {3.876388874777326*^9, 
   3.876388875009164*^9}, 3.876388926834021*^9, 3.876545897410365*^9, 
   3.876546877634027*^9, 3.876547012070548*^9, 3.876556256487472*^9, 
   3.876556717970819*^9, 3.876560112282793*^9, 3.8765601718768682`*^9, 
   3.8765609488515263`*^9, {3.876565089213463*^9, 3.8765651419895573`*^9}, 
   3.876572676171049*^9, 3.876997261206531*^9, 3.87862626186866*^9, 
   3.8786264072763968`*^9, 3.878627348043643*^9, 3.878627455498527*^9, 
   3.878627538260483*^9, 3.878627870473927*^9, 3.878628147895549*^9, 
   3.878628837612735*^9, 3.8786288795233192`*^9, {3.878628914858624*^9, 
   3.87862894201215*^9}, 3.878636240043243*^9, 3.878636284123322*^9, 
   3.878636996294552*^9, 3.8786371190634527`*^9, {3.878637162260038*^9, 
   3.878637212391782*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"32", "+", 
    RowBox[{"17", " ", "M"}], "+", 
    RowBox[{"351.75069822137294`", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "M"}], ")"}]}]}], ",", 
   RowBox[{"357.75069822137294`", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "M"}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"351.75069822137294`", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "M"}], ")"}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{"6", "+", 
       RowBox[{"5", " ", "M"}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, {
   3.8763867512289867`*^9, 3.8763868387229633`*^9}, {3.876388874777326*^9, 
   3.876388875009164*^9}, 3.876388926834021*^9, 3.876545897410365*^9, 
   3.876546877634027*^9, 3.876547012070548*^9, 3.876556256487472*^9, 
   3.876556717970819*^9, 3.876560112282793*^9, 3.8765601718768682`*^9, 
   3.8765609488515263`*^9, {3.876565089213463*^9, 3.8765651419895573`*^9}, 
   3.876572676171049*^9, 3.876997261206531*^9, 3.87862626186866*^9, 
   3.8786264072763968`*^9, 3.878627348043643*^9, 3.878627455498527*^9, 
   3.878627538260483*^9, 3.878627870473927*^9, 3.878628147895549*^9, 
   3.878628837612735*^9, 3.8786288795233192`*^9, {3.878628914858624*^9, 
   3.87862894201215*^9}, 3.878636240043243*^9, 3.878636284123322*^9, 
   3.878636996294552*^9, 3.8786371190634527`*^9, {3.878637162260038*^9, 
   3.878637212393609*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"M", "\[Rule]", 
     RowBox[{"-", "0.026095944271839786`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"M", "\[Rule]", "68.97623558854643`"}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, {
   3.8763867512289867`*^9, 3.8763868387229633`*^9}, {3.876388874777326*^9, 
   3.876388875009164*^9}, 3.876388926834021*^9, 3.876545897410365*^9, 
   3.876546877634027*^9, 3.876547012070548*^9, 3.876556256487472*^9, 
   3.876556717970819*^9, 3.876560112282793*^9, 3.8765601718768682`*^9, 
   3.8765609488515263`*^9, {3.876565089213463*^9, 3.8765651419895573`*^9}, 
   3.876572676171049*^9, 3.876997261206531*^9, 3.87862626186866*^9, 
   3.8786264072763968`*^9, 3.878627348043643*^9, 3.878627455498527*^9, 
   3.878627538260483*^9, 3.878627870473927*^9, 3.878628147895549*^9, 
   3.878628837612735*^9, 3.8786288795233192`*^9, {3.878628914858624*^9, 
   3.87862894201215*^9}, 3.878636240043243*^9, 3.878636284123322*^9, 
   3.878636996294552*^9, 3.8786371190634527`*^9, {3.878637162260038*^9, 
   3.8786372123953733`*^9}}],

Cell[BoxData["68"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, {
   3.8763867512289867`*^9, 3.8763868387229633`*^9}, {3.876388874777326*^9, 
   3.876388875009164*^9}, 3.876388926834021*^9, 3.876545897410365*^9, 
   3.876546877634027*^9, 3.876547012070548*^9, 3.876556256487472*^9, 
   3.876556717970819*^9, 3.876560112282793*^9, 3.8765601718768682`*^9, 
   3.8765609488515263`*^9, {3.876565089213463*^9, 3.8765651419895573`*^9}, 
   3.876572676171049*^9, 3.876997261206531*^9, 3.87862626186866*^9, 
   3.8786264072763968`*^9, 3.878627348043643*^9, 3.878627455498527*^9, 
   3.878627538260483*^9, 3.878627870473927*^9, 3.878628147895549*^9, 
   3.878628837612735*^9, 3.8786288795233192`*^9, {3.878628914858624*^9, 
   3.87862894201215*^9}, 3.878636240043243*^9, 3.878636284123322*^9, 
   3.878636996294552*^9, 3.8786371190634527`*^9, {3.878637162260038*^9, 
   3.8786372123965282`*^9}}],

Cell[BoxData["3.016027389667171`"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, {
   3.8763867512289867`*^9, 3.8763868387229633`*^9}, {3.876388874777326*^9, 
   3.876388875009164*^9}, 3.876388926834021*^9, 3.876545897410365*^9, 
   3.876546877634027*^9, 3.876547012070548*^9, 3.876556256487472*^9, 
   3.876556717970819*^9, 3.876560112282793*^9, 3.8765601718768682`*^9, 
   3.8765609488515263`*^9, {3.876565089213463*^9, 3.8765651419895573`*^9}, 
   3.876572676171049*^9, 3.876997261206531*^9, 3.87862626186866*^9, 
   3.8786264072763968`*^9, 3.878627348043643*^9, 3.878627455498527*^9, 
   3.878627538260483*^9, 3.878627870473927*^9, 3.878628147895549*^9, 
   3.878628837612735*^9, 3.8786288795233192`*^9, {3.878628914858624*^9, 
   3.87862894201215*^9}, 3.878636240043243*^9, 3.878636284123322*^9, 
   3.878636996294552*^9, 3.8786371190634527`*^9, {3.878637162260038*^9, 
   3.878637212397571*^9}}],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, {
   3.8763867512289867`*^9, 3.8763868387229633`*^9}, {3.876388874777326*^9, 
   3.876388875009164*^9}, 3.876388926834021*^9, 3.876545897410365*^9, 
   3.876546877634027*^9, 3.876547012070548*^9, 3.876556256487472*^9, 
   3.876556717970819*^9, 3.876560112282793*^9, 3.8765601718768682`*^9, 
   3.8765609488515263`*^9, {3.876565089213463*^9, 3.8765651419895573`*^9}, 
   3.876572676171049*^9, 3.876997261206531*^9, 3.87862626186866*^9, 
   3.8786264072763968`*^9, 3.878627348043643*^9, 3.878627455498527*^9, 
   3.878627538260483*^9, 3.878627870473927*^9, 3.878628147895549*^9, 
   3.878628837612735*^9, 3.8786288795233192`*^9, {3.878628914858624*^9, 
   3.87862894201215*^9}, 3.878636240043243*^9, 3.878636284123322*^9, 
   3.878636996294552*^9, 3.8786371190634527`*^9, {3.878637162260038*^9, 
   3.878637212398609*^9}}],

Cell[BoxData["1466.5013964427458`"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, {
   3.8763867512289867`*^9, 3.8763868387229633`*^9}, {3.876388874777326*^9, 
   3.876388875009164*^9}, 3.876388926834021*^9, 3.876545897410365*^9, 
   3.876546877634027*^9, 3.876547012070548*^9, 3.876556256487472*^9, 
   3.876556717970819*^9, 3.876560112282793*^9, 3.8765601718768682`*^9, 
   3.8765609488515263`*^9, {3.876565089213463*^9, 3.8765651419895573`*^9}, 
   3.876572676171049*^9, 3.876997261206531*^9, 3.87862626186866*^9, 
   3.8786264072763968`*^9, 3.878627348043643*^9, 3.878627455498527*^9, 
   3.878627538260483*^9, 3.878627870473927*^9, 3.878628147895549*^9, 
   3.878628837612735*^9, 3.8786288795233192`*^9, {3.878628914858624*^9, 
   3.87862894201215*^9}, 3.878636240043243*^9, 3.878636284123322*^9, 
   3.878636996294552*^9, 3.8786371190634527`*^9, {3.878637162260038*^9, 
   3.8786372123995867`*^9}}],

Cell[BoxData["1.5`"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, {
   3.8763867512289867`*^9, 3.8763868387229633`*^9}, {3.876388874777326*^9, 
   3.876388875009164*^9}, 3.876388926834021*^9, 3.876545897410365*^9, 
   3.876546877634027*^9, 3.876547012070548*^9, 3.876556256487472*^9, 
   3.876556717970819*^9, 3.876560112282793*^9, 3.8765601718768682`*^9, 
   3.8765609488515263`*^9, {3.876565089213463*^9, 3.8765651419895573`*^9}, 
   3.876572676171049*^9, 3.876997261206531*^9, 3.87862626186866*^9, 
   3.8786264072763968`*^9, 3.878627348043643*^9, 3.878627455498527*^9, 
   3.878627538260483*^9, 3.878627870473927*^9, 3.878628147895549*^9, 
   3.878628837612735*^9, 3.8786288795233192`*^9, {3.878628914858624*^9, 
   3.87862894201215*^9}, 3.878636240043243*^9, 3.878636284123322*^9, 
   3.878636996294552*^9, 3.8786371190634527`*^9, {3.878637162260038*^9, 
   3.87863721240055*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", ",", "9", 
   ",", "10", ",", "11", ",", "12", ",", "13", ",", "14", ",", "15", ",", 
   "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "21", ",", "22", 
   ",", "23", ",", "24", ",", "25", ",", "26", ",", "27", ",", "28", ",", 
   "29", ",", "30", ",", "31", ",", "32", ",", "33", ",", "34", ",", "35", 
   ",", "36", ",", "37", ",", "38", ",", "39", ",", "40", ",", "41", ",", 
   "42", ",", "43"}], "}"}]], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, {
   3.8763867512289867`*^9, 3.8763868387229633`*^9}, {3.876388874777326*^9, 
   3.876388875009164*^9}, 3.876388926834021*^9, 3.876545897410365*^9, 
   3.876546877634027*^9, 3.876547012070548*^9, 3.876556256487472*^9, 
   3.876556717970819*^9, 3.876560112282793*^9, 3.8765601718768682`*^9, 
   3.8765609488515263`*^9, {3.876565089213463*^9, 3.8765651419895573`*^9}, 
   3.876572676171049*^9, 3.876997261206531*^9, 3.87862626186866*^9, 
   3.8786264072763968`*^9, 3.878627348043643*^9, 3.878627455498527*^9, 
   3.878627538260483*^9, 3.878627870473927*^9, 3.878628147895549*^9, 
   3.878628837612735*^9, 3.8786288795233192`*^9, {3.878628914858624*^9, 
   3.87862894201215*^9}, 3.878636240043243*^9, 3.878636284123322*^9, 
   3.878636996294552*^9, 3.8786371190634527`*^9, {3.878637162260038*^9, 
   3.8786372124015083`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJw10gtIU1Ecx/Gba0t72LKyFlpbLy1Mp5urzcd+bvM1LaeVWhRlYg9WaZZY
aDAhC4x8VWpQJrOyoZBmQjVyRrko3XpIUVFECWZFYC41reyB/3PhcPnc77lw
OOdIdmSnZLlxHKf7N/6/J54BtUX4O9G+Y0RNH1BwoE3xw/Kb7I78Csdsa/4k
TFiIzEM7RwJreOQ5SPOZc1cXwSfPR/PgQmn0QQHZByXOKYWS+ClkMYLi9uRm
OZkXw+dY0Ky3s9zJS3HhWs/IMzHzcgSffGxvFzD7Q9a4yyvcwf5fiZR3qmcr
C5kDMN+2pa5XxBwIy6qKBbmNbD1SBES1VDvkzMFYU+RKmH6LrT8E1ty0rWUq
ZhlqO8M6/ayTyXIYFolPycOZQ+H3epra2s72Q4G3zz0OFmiZV+PxYGXq+CM3
8hpcLfX+Zt7IrISHr7qroZftrwr7XS+KQvKYw7AZR1o3TmUOR0Wyxjy3niNH
wOP44SdGNXMkVHkNdafb/9D5qZE+Tden4DMD0qOSofKU8QmbgNhdD53GK+y8
o3BfJhw+xZFNUcjZsGfUuv0XdQ2aWjtqb9l/Utegynm4Ux9C5rQYn2n1lNeP
UdeiUuBIDxOROR2U/Mx5/mdGqetw40Bn+b3ZZC4aviUD/FfVP6hHY+mM4keh
YjIXg89fUg2WJrqvphg4MqpW8CPY/Y2Fn+ELz/fpMPVYzHPfVGvfTebikLN+
s/UVj/U4SDo2CKXmIerxSNymkV3Wkk3xqLFFnvDu/05dj35RoX9mGdmkx2ql
4KVRyXoCbr+5+NGrz0U9AXe6XcvCz5K5RGQWabu6Y1hPREBwy87GsUHqa6Fv
U3bbmsmmtTBsN/Jcu1lfh5uq94qgJayvwwNb8aVt775RT4Lo4/nSnAtkUxJu
dlWuStrKugHOvSXmTwvJMCDw+pXPgR8GaL4B2u+CHs8GcocB55qyvx7ZR+aS
kV5TXZwROqD+CzUTJjk=
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{1., 1.0130324572033},
  Method->{},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, {
   3.8763867512289867`*^9, 3.8763868387229633`*^9}, {3.876388874777326*^9, 
   3.876388875009164*^9}, 3.876388926834021*^9, 3.876545897410365*^9, 
   3.876546877634027*^9, 3.876547012070548*^9, 3.876556256487472*^9, 
   3.876556717970819*^9, 3.876560112282793*^9, 3.8765601718768682`*^9, 
   3.8765609488515263`*^9, {3.876565089213463*^9, 3.8765651419895573`*^9}, 
   3.876572676171049*^9, 3.876997261206531*^9, 3.87862626186866*^9, 
   3.8786264072763968`*^9, 3.878627348043643*^9, 3.878627455498527*^9, 
   3.878627538260483*^9, 3.878627870473927*^9, 3.878628147895549*^9, 
   3.878628837612735*^9, 3.8786288795233192`*^9, {3.878628914858624*^9, 
   3.87862894201215*^9}, 3.878636240043243*^9, 3.878636284123322*^9, 
   3.878636996294552*^9, 3.8786371190634527`*^9, {3.878637162260038*^9, 
   3.878637212402691*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Best strategy ", "Subsection",
 CellChangeTimes->{{3.876386294229916*^9, 3.876386298685363*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bestCostWithComm", " ", "=", " ", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"costWithComm", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"M", "\[Rule]", "x"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1", ",", "breakEven"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"costWithCommLarge", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"M", "\[Rule]", "x"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"breakEven", "+", "1"}], ",", "maxM"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "bestCostWithComm", "]"}]}], "Code",
 CellChangeTimes->{{3.8763863084943447`*^9, 3.8763864302263527`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1: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
etzX0b1ZOV2L3GBhLhX5pCzKDqqn/wCw9wxZ
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 200.}, {0, 116140.1534817622}},
  PlotRangeClipping->True,
  PlotRangePadding->{{4., 4.}, {2322.803069635244, 
   2322.803069635244}}]], "Output",
 CellChangeTimes->{
  3.8763864308388166`*^9, 3.876386751300392*^9, 3.8763888748586206`*^9, 
   3.876545897521863*^9, 3.876546877708362*^9, 3.876547012149145*^9, 
   3.876556256565036*^9, 3.876556718045046*^9, 3.876560112371064*^9, 
   3.876560171945764*^9, 3.876560948926437*^9, {3.876565089283977*^9, 
   3.876565142052981*^9}, 3.876572676253577*^9, 3.8769972614114237`*^9, 
   3.8786262619705877`*^9, 3.8786281703856916`*^9, 3.8786288377013197`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.87638637542977*^9, 3.8763863858549757`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Based on the univariate strategy", "Section",
 CellChangeTimes->{{3.876385540206491*^9, 3.8763855496770477`*^9}, {
  3.8763859504295197`*^9, 3.876385954050096*^9}}],

Cell[CellGroupData[{

Cell["small number of columns", "Subsection",
 CellChangeTimes->{{3.87657262920255*^9, 3.8765726324865093`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"arithComp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"M", "+", "1"}], ")"}]}], "+", "3"}], ",", "2", ",", "1"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"costsumcheckUV", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"sumcheck", "[", 
     RowBox[{"n", ",", " ", 
      RowBox[{"M", "+", "3"}], ",", " ", 
      RowBox[{
       RowBox[{"2", "M"}], "+", "6"}], ",", " ", "arithComp"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", " ", "-", " ", 
      RowBox[{"1", "/", 
       RowBox[{"2", "^", "n"}]}]}], ")"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"costUV", " ", "=", " ", 
  RowBox[{
   RowBox[{"costsumcheckUV", "+", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"M", "+", "1"}], ")"}]}], "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "M"}], "+", "4"}], ")"}], "+", "2"}], ",", " ", "0", 
      ",", " ", 
      RowBox[{
       RowBox[{"3", "M"}], "+", "5"}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Code",
 CellChangeTimes->{{3.8750909259659147`*^9, 3.8750909755423727`*^9}, {
   3.875091011817265*^9, 3.875091011971953*^9}, {3.875091761347869*^9, 
   3.8750917685033712`*^9}, {3.875095922978674*^9, 3.875095924237027*^9}, {
   3.875102731687755*^9, 3.875102732249934*^9}, {3.8751027766648827`*^9, 
   3.8751027771588306`*^9}, {3.8751035450282717`*^9, 3.875103545106289*^9}, {
   3.875103575541709*^9, 3.875103575695881*^9}, {3.87544903570872*^9, 
   3.875449051990718*^9}, {3.875459791604109*^9, 3.875459793447543*^9}, {
   3.875460098494342*^9, 3.875460146550344*^9}, 3.8754622749212112`*^9, {
   3.8754623550682497`*^9, 3.875462355922514*^9}, {3.8754628105165787`*^9, 
   3.8754628283143*^9}, {3.875462860582975*^9, 3.875462874171104*^9}, {
   3.8754629739336987`*^9, 3.8754629980591993`*^9}, {3.875464304445507*^9, 
   3.8754643097529507`*^9}, {3.875464374646179*^9, 3.875464379549264*^9}, {
   3.875464667348877*^9, 3.875464667406427*^9}, {3.875464789979189*^9, 
   3.87546480291568*^9}, {3.875464900566935*^9, 3.875464925993936*^9}, {
   3.8754665630601683`*^9, 3.875466563364303*^9}, {3.875603537872497*^9, 
   3.875603540199489*^9}, {3.87560358270327*^9, 3.875603659183642*^9}, {
   3.875604134438981*^9, 3.875604134819813*^9}, 3.875604513449641*^9, {
   3.8757017826018*^9, 3.87570182248929*^9}, {3.876295114711844*^9, 
   3.876295115023265*^9}, {3.876385582696113*^9, 3.876385587334529*^9}, {
   3.8763857218627453`*^9, 3.8763857221737823`*^9}, {3.8763859659634027`*^9, 
   3.8763860077477903`*^9}, {3.876572531010734*^9, 3.876572583060375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"38", "+", 
    RowBox[{"25", " ", "M"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["M", "2"]}]}], ",", 
   RowBox[{"14", "+", 
    RowBox[{"4", " ", "M"}]}], ",", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"13", "+", 
      RowBox[{"7", " ", "M"}], "+", 
      SuperscriptBox["M", "2"]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385715009602*^9, 3.876385722596904*^9}, 
   3.876386008897937*^9, 3.876386751315452*^9, 3.8763888748686457`*^9, 
   3.876545897538424*^9, 3.876546877718638*^9, 3.876547012161355*^9, 
   3.876556256580185*^9, 3.876556718056282*^9, 3.876560112393311*^9, 
   3.8765601719581823`*^9, 3.8765609489446907`*^9, {3.876565089295424*^9, 
   3.876565142063918*^9}, 3.876572584959175*^9, 3.876572676264659*^9, 
   3.876572738584547*^9, 3.8769972614221373`*^9, 3.878626261983583*^9, 
   3.878628837713353*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"46", "+", 
    RowBox[{"29", " ", "M"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["M", "2"]}]}], ",", 
   RowBox[{"14", "+", 
    RowBox[{"4", " ", "M"}]}], ",", 
   RowBox[{"31", "+", 
    RowBox[{"17", " ", "M"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["M", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385715009602*^9, 3.876385722596904*^9}, 
   3.876386008897937*^9, 3.876386751315452*^9, 3.8763888748686457`*^9, 
   3.876545897538424*^9, 3.876546877718638*^9, 3.876547012161355*^9, 
   3.876556256580185*^9, 3.876556718056282*^9, 3.876560112393311*^9, 
   3.8765601719581823`*^9, 3.8765609489446907`*^9, {3.876565089295424*^9, 
   3.876565142063918*^9}, 3.876572584959175*^9, 3.876572676264659*^9, 
   3.876572738584547*^9, 3.8769972614221373`*^9, 3.878626261983583*^9, 
   3.8786288377141542`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["large number of columns", "Subsection",
 CellChangeTimes->{{3.876385600508483*^9, 3.876385604712728*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"arithComp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"5", ",", "2", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"costsumcheckUVlarge", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M", "+", "1"}], ")"}], " ", "*", " ", 
    RowBox[{
     RowBox[{"sumcheck", "[", 
      RowBox[{
       RowBox[{"n", "+", "m"}], ",", " ", "3", ",", " ", "6", ",", " ", 
       "arithComp"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", " ", "-", " ", 
       RowBox[{"1", "/", 
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"n", "+", "m"}], ")"}]}]}]}], ")"}]}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"costUVlarge", " ", "=", " ", 
  RowBox[{
   RowBox[{"costsumcheckUVlarge", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"M", "+", "1"}], ")"}], 
     RowBox[{"{", 
      RowBox[{"7", ",", " ", "0", ",", " ", "4"}], "}"}]}]}], "//", 
   "Simplify"}]}]}], "Code",
 CellChangeTimes->{{3.8750909259659147`*^9, 3.8750909755423727`*^9}, {
   3.875091011817265*^9, 3.875091011971953*^9}, {3.875091761347869*^9, 
   3.8750917685033712`*^9}, {3.875095922978674*^9, 3.875095924237027*^9}, {
   3.875102731687755*^9, 3.875102732249934*^9}, {3.8751027766648827`*^9, 
   3.8751027771588306`*^9}, {3.8751035450282717`*^9, 3.875103545106289*^9}, {
   3.875103575541709*^9, 3.875103575695881*^9}, {3.87544903570872*^9, 
   3.875449051990718*^9}, {3.875459791604109*^9, 3.875459793447543*^9}, {
   3.875460098494342*^9, 3.875460146550344*^9}, 3.8754622749212112`*^9, {
   3.8754623550682497`*^9, 3.875462355922514*^9}, {3.8754628105165787`*^9, 
   3.8754628283143*^9}, {3.875462860582975*^9, 3.875462874171104*^9}, {
   3.8754629739336987`*^9, 3.8754629980591993`*^9}, {3.875464304445507*^9, 
   3.8754643097529507`*^9}, {3.875464374646179*^9, 3.875464379549264*^9}, {
   3.875464667348877*^9, 3.875464667406427*^9}, {3.875464789979189*^9, 
   3.87546480291568*^9}, {3.875464900566935*^9, 3.875464925993936*^9}, {
   3.8754665630601683`*^9, 3.875466563364303*^9}, {3.875603537872497*^9, 
   3.875603540199489*^9}, {3.87560358270327*^9, 3.875603659183642*^9}, {
   3.875604134438981*^9, 3.875604134819813*^9}, 3.875604513449641*^9, {
   3.8757017826018*^9, 3.87570182248929*^9}, {3.876294935922762*^9, 
   3.876294976871594*^9}, {3.8762950096121683`*^9, 3.87629504286515*^9}, {
   3.876295088768346*^9, 3.876295091983234*^9}, {3.876295140653759*^9, 
   3.8762952201241207`*^9}, {3.8762954318300037`*^9, 3.876295438845056*^9}, {
   3.876368111846792*^9, 3.876368114205063*^9}, {3.876385621768506*^9, 
   3.876385712184557*^9}, {3.8763859817375793`*^9, 3.87638599991722*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"38", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "M"}], ")"}]}], ",", 
   RowBox[{"14", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "M"}], ")"}]}], ",", 
   RowBox[{"26", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "M"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385715044609*^9, 3.876385715142146*^9}, 
   3.876386016882557*^9, 3.876386751338686*^9, 3.876388874890017*^9, 
   3.876545897562159*^9, 3.876546877744257*^9, 3.876547012184167*^9, 
   3.87655625660221*^9, 3.876556718078918*^9, 3.8765601124171124`*^9, 
   3.876560171975246*^9, 3.8765609489653463`*^9, {3.876565089312255*^9, 
   3.876565142080762*^9}, 3.87657267628866*^9, 3.87699726147366*^9, 
   3.878626262010221*^9, 3.878628837734626*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"45", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "M"}], ")"}]}], ",", 
   RowBox[{"14", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "M"}], ")"}]}], ",", 
   RowBox[{"30", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "M"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385715044609*^9, 3.876385715142146*^9}, 
   3.876386016882557*^9, 3.876386751338686*^9, 3.876388874890017*^9, 
   3.876545897562159*^9, 3.876546877744257*^9, 3.876547012184167*^9, 
   3.87655625660221*^9, 3.876556718078918*^9, 3.8765601124171124`*^9, 
   3.876560171975246*^9, 3.8765609489653463`*^9, {3.876565089312255*^9, 
   3.876565142080762*^9}, 3.87657267628866*^9, 3.87699726147366*^9, 
   3.878626262010221*^9, 3.8786288377354116`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["break even point", "Subsection",
 CellChangeTimes->{{3.876385748469411*^9, 3.876385752247199*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"costWithCommUV", " ", "=", " ", 
  RowBox[{"costUV", " ", "+", " ", 
   RowBox[{"costPippengerPerScalar", " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{"M", "+", "2"}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"costWithCommUVlarge", " ", "=", " ", 
   RowBox[{"costUVlarge", " ", "+", " ", 
    RowBox[{"costPippengerPerScalar", " ", "*", " ", "2", "*", 
     RowBox[{"(", 
      RowBox[{"M", "+", "1"}], ")"}]}]}]}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "break", " ", "even", " ", "point", " ", "with", " ", "linear", " ", 
    "strategy"}], " ", "*)"}]}], "\n", 
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"NSolve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"costWithCommUV", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
     RowBox[{"costWithCommUVlarge", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "M"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"breakEvenUV", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"M", " ", "/.", " ", "sol"}], " ", "//", " ", "Last"}], "//", 
    "Floor"}]}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"maximum", " ", "speedup"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"ratio", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"costWithCommUVlarge", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/", 
       RowBox[{"costWithCommUV", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"M", "\[Rule]", "x"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", " ", "breakEvenUV"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"max", " ", "=", " ", 
   RowBox[{"Max", "@", "ratio"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"max", "//", "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"best", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"ratio", ",", "max"}], "]"}], "//", "Flatten"}], "//", 
    "First"}]}], "\n", "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "range", " ", "for", " ", "0.8", " ", "of", " ", "the", " ", "maximum", 
    " ", "speedup"}], " ", "*)"}]}], "\n", 
 RowBox[{"max", " ", "*", " ", "0.80"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "\[GreaterEqual]", 
         RowBox[{"max", "*", "0.80"}]}], ")"}], "&"}], "/@", "ratio"}], ",", 
     "True"}], "]"}], "//", "Flatten"}], "\n"}], "\n", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"ratio", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "16"}], "]"}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\n", 
 RowBox[{"ratio", "[", 
  RowBox[{"[", "8", "]"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"costWithCommUV", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"M", "\[Rule]", "8"}], "}"}]}]}], "Code",
 CellChangeTimes->{{3.8763858044317017`*^9, 3.876385921151272*^9}, {
  3.876386031692253*^9, 3.8763861394701977`*^9}, {3.876386871077985*^9, 
  3.8763868856803837`*^9}, {3.8786354731372957`*^9, 3.878635482332808*^9}, {
  3.878636312692054*^9, 3.87863637383992*^9}, {3.878637251007493*^9, 
  3.8786372698900433`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"46", "+", 
    RowBox[{"29", " ", "M"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["M", "2"]}], "+", 
    RowBox[{"557.9611558503079`", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "M"}], ")"}]}]}], ",", 
   RowBox[{"14", "+", 
    RowBox[{"4", " ", "M"}], "+", 
    RowBox[{"557.9611558503079`", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "M"}], ")"}]}]}], ",", 
   RowBox[{"31", "+", 
    RowBox[{"17", " ", "M"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["M", "2"]}], "+", 
    RowBox[{"557.9611558503079`", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "M"}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.8786373752584248`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1160.9223117006159`", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "M"}], ")"}]}], ",", 
   RowBox[{"1129.9223117006159`", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "M"}], ")"}]}], ",", 
   RowBox[{"1145.9223117006159`", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "M"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.878637375259919*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"M", "\[Rule]", "0.0017422993389621553`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"M", "\[Rule]", "143.48854666323803`"}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.87863737526132*^9}],

Cell[BoxData["143"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.8786373752623167`*^9}],

Cell[BoxData["1.7193552968081192`"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.878637375262912*^9}],

Cell[BoxData["11"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.8786373752634583`*^9}],

Cell[BoxData["1.3754842374464955`"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.87863737526399*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", ",", "9", 
   ",", "10", ",", "11", ",", "12", ",", "13", ",", "14", ",", "15", ",", 
   "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "21", ",", "22", 
   ",", "23", ",", "24", ",", "25", ",", "26", ",", "27", ",", "28", ",", 
   "29", ",", "30", ",", "31", ",", "32", ",", "33", ",", "34", ",", "35", 
   ",", "36", ",", "37", ",", "38", ",", "39", ",", "40", ",", "41", ",", 
   "42", ",", "43", ",", "44", ",", "45", ",", "46", ",", "47", ",", "48", 
   ",", "49", ",", "50", ",", "51", ",", "52", ",", "53", ",", "54", ",", 
   "55", ",", "56", ",", "57", ",", "58", ",", "59", ",", "60", ",", "61", 
   ",", "62", ",", "63"}], "}"}]], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.878637375264709*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], 
    PointBox[{{1., 1.3245858417760328`}, {2., 1.480866082923913}, {3., 
     1.5694471328148927`}, {4., 1.624227786509994}, {5., 
     1.6597534363069375`}, {6., 1.6833014236131145`}, {7., 
     1.6989157545355549`}, {8., 1.7090226792007397`}, {9., 
     1.7151656053554276`}, {10., 1.7183727682259424`}, {11., 
     1.7193552968081192`}, {12., 1.7186204360055484`}, {13., 
     1.7165395001127937`}, {14., 1.7133903540507218`}, {15., 
     1.7093849066406708`}, {16., 1.704687442332515}}]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{1., 1.3245858417760328`},
  Method->{},
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.8786373752655373`*^9}],

Cell[BoxData["1.7090226792007397`"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.878637375268774*^9}],

Cell[BoxData["6113.611558503079`"], "Output",
 CellChangeTimes->{{3.876385910047246*^9, 3.876385923439322*^9}, 
   3.8763861470907803`*^9, 3.876386751344759*^9, 3.876386886276246*^9, 
   3.8763888748981743`*^9, 3.876545897568553*^9, 3.876546877751233*^9, 
   3.876547012193437*^9, 3.876556256611607*^9, 3.876556718102483*^9, 
   3.876560112421912*^9, 3.8765601719939823`*^9, 3.876560948972204*^9, {
   3.876565089318849*^9, 3.876565142087329*^9}, 3.8765726762957087`*^9, 
   3.876997261525393*^9, 3.8786262620363703`*^9, 3.878628199489986*^9, 
   3.878628837741688*^9, 3.878635483027767*^9, 3.8786356743391743`*^9, 
   3.878635719688368*^9, 3.878635759063119*^9, {3.878636345554496*^9, 
   3.878636374510602*^9}, {3.8786372521573*^9, 3.8786372705520153`*^9}, 
   3.878637302632194*^9, 3.878637342572859*^9, 3.878637375269404*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["best strategy", "Subsection",
 CellChangeTimes->{{3.8763865017050533`*^9, 3.876386504201005*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bestCostWithCommUV", " ", "=", " ", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"costWithCommUV", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"M", "\[Rule]", "x"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1", ",", "breakEvenUV"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"costWithCommUVlarge", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"M", "\[Rule]", "x"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"breakEvenUV", "+", "1"}], ",", "maxM"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "bestCostWithCommUV", "]"}]}], "Code",
 CellChangeTimes->{{3.876386459981937*^9, 3.876386492348509*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1: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
j3dsM8/B93+y061V
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 200.}, {0, 233345.38465182378`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{4., 4.}, {4666.907693036475, 
   4666.907693036475}}]], "Output",
 CellChangeTimes->{{3.876386483448996*^9, 3.876386492962757*^9}, 
   3.876386751374456*^9, 3.87638887493642*^9, 3.876545897625967*^9, 
   3.876546877811241*^9, 3.876547012247064*^9, 3.876556256663608*^9, 
   3.876556718134581*^9, 3.8765601124712*^9, 3.876560172013389*^9, 
   3.876560949011223*^9, {3.876565089351614*^9, 3.876565142117313*^9}, 
   3.8765726763488083`*^9, 3.876997261633602*^9, 3.878626262072201*^9, 
   3.878628216480279*^9, 3.8786288377868557`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparison", "Section",
 CellChangeTimes->{{3.87638651335948*^9, 3.876386514714394*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"bestCostWithCommUV", "/", "bestCostWithComm"}], "]"}]], "Code",
 CellChangeTimes->{{3.878638983700768*^9, 3.878638999063628*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1: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
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 1.500856221334229},
  Method->{},
  PlotRange->{{0, 200.}, {1.500856221334229, 4.141258146630319}},
  PlotRangeClipping->True,
  PlotRangePadding->{{4., 4.}, {0.052808038505921806`, 
   0.052808038505921806`}}]], "Output",
 CellChangeTimes->{3.8786389996760674`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "number", " ", "of", " ", "muls", " ", "for", " ", "optimal", 
    " ", "batch", " ", "size", " ", "M"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dom", "=", 
     RowBox[{"{", 
      RowBox[{"12", ",", "14", ",", "16", ",", "18"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logDer", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "2296"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "1959"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11", ",", "1680"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "1466"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plookup", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"8", ",", "6113"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "5174"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "4474"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "4052"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"logDerPerCol", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "/@", "logDer"}], " ", "//",
      "N"}]}], "\[IndentingNewLine]", 
   RowBox[{"plookupPerCol", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "/@", "plookup"}], " ", "//",
      "N"}]}], "\[IndentingNewLine]", 
   RowBox[{"plookupPerCol", "/", "logDerPerCol"}]}]}]], "Input",
 CellChangeTimes->{{3.878637068384368*^9, 3.8786372317751904`*^9}, {
  3.878637277963189*^9, 3.8786375380316677`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "176.6153846153846`", ",", "163.25`", ",", "152.72727272727272`", ",", 
   "146.6`"}], "}"}]], "Output",
 CellChangeTimes->{{3.878637487525784*^9, 3.8786375385450077`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"764.125`", ",", "646.75`", ",", "559.25`", ",", "506.5`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.878637487525784*^9, 3.8786375385465803`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.326491724738676`", ",", "3.961715160796325`", ",", "3.6617559523809526`",
    ",", "3.454979536152797`"}], "}"}]], "Output",
 CellChangeTimes->{{3.878637487525784*^9, 3.878637538547526*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{960, 1028},
WindowMargins->{{-10, Automatic}, {Automatic, -10}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 1920, 50, 129, "Code"],
Cell[CellGroupData[{
Cell[2502, 74, 3006, 79, 357, "Code"],
Cell[5511, 155, 545, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6093, 171, 860, 21, 90, "Code"],
Cell[6956, 194, 877, 12, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7870, 211, 122, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[8017, 216, 110, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[8152, 221, 2344, 47, 90, "Code"],
Cell[10499, 270, 909, 21, 37, "Output"],
Cell[11411, 293, 883, 20, 37, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12343, 319, 170, 2, 44, "Subsection"],
Cell[12516, 323, 2984, 58, 147, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[15537, 386, 211, 3, 36, "Subsection"],
Cell[CellGroupData[{
Cell[15773, 393, 2910, 58, 90, "Code"],
Cell[18686, 453, 882, 20, 32, "Output"],
Cell[19571, 475, 860, 19, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20480, 500, 104, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[20609, 505, 3021, 82, 413, "Code"],
Cell[23633, 589, 1353, 25, 37, "Output"],
Cell[24989, 616, 1445, 31, 32, "Output"],
Cell[26437, 649, 1131, 21, 32, "Output"],
Cell[27571, 672, 917, 13, 32, "Output"],
Cell[28491, 687, 931, 13, 32, "Output"],
Cell[29425, 702, 915, 13, 32, "Output"],
Cell[30343, 717, 934, 13, 32, "Output"],
Cell[31280, 732, 916, 13, 32, "Output"],
Cell[32199, 747, 1422, 22, 55, "Output"],
Cell[33624, 771, 2198, 39, 241, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35871, 816, 102, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[35998, 821, 1027, 27, 128, "Code"],
Cell[37028, 850, 2929, 53, 228, "Output"]
}, Open  ]],
Cell[39972, 906, 93, 1, 32, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[40114, 913, 170, 2, 50, "Section"],
Cell[CellGroupData[{
Cell[40309, 919, 112, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[40446, 924, 2707, 59, 90, "Code"],
Cell[43156, 985, 909, 21, 37, "Output"],
Cell[44068, 1008, 883, 20, 37, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45000, 1034, 111, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[45136, 1039, 2688, 54, 90, "Code"],
Cell[47827, 1095, 778, 18, 32, "Output"],
Cell[48608, 1115, 780, 18, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49437, 1139, 104, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[49566, 1144, 3280, 90, 451, "Code"],
Cell[52849, 1236, 1460, 32, 37, "Output"],
Cell[54312, 1270, 1146, 22, 32, "Output"],
Cell[55461, 1294, 1007, 18, 32, "Output"],
Cell[56471, 1314, 816, 11, 32, "Output"],
Cell[57290, 1327, 830, 11, 32, "Output"],
Cell[58123, 1340, 815, 11, 32, "Output"],
Cell[58941, 1353, 829, 11, 32, "Output"],
Cell[59773, 1366, 1550, 23, 77, "Output"],
Cell[61326, 1391, 1559, 27, 242, "Output"],
Cell[62888, 1420, 830, 11, 32, "Output"],
Cell[63721, 1433, 829, 11, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64599, 1450, 103, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[64727, 1455, 1035, 27, 128, "Code"],
Cell[65765, 1484, 3413, 61, 227, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69239, 1552, 94, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[69358, 1557, 181, 3, 51, "Code"],
Cell[69542, 1562, 3121, 56, 241, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72700, 1623, 1995, 60, 165, "Input"],
Cell[74698, 1685, 214, 5, 32, "Output"],
Cell[74915, 1692, 188, 4, 32, "Output"],
Cell[75106, 1698, 235, 5, 32, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
